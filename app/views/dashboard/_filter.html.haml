= form_tag dashboard_filter_path(entity), method: 'get' do
  %fieldset.dashboard-search-filter
    = search_field_tag "search", params[:search], { id: 'filter_search', placeholder: 'Search', class: 'search-text-input' }
    = button_tag type: 'submit', class: 'btn' do
      %i.icon-search

  %fieldset
    %legend Status:
    %ul.nav.nav-pills.nav-stacked
      %li{class: ("active" if !params[:status])}
        = link_to dashboard_filter_path(entity, status: nil) do
          Open
          %span.count
            = Issue.opened.count if entity == 'issue'
            = current_user.cared_merge_requests.opened.count if entity == 'merge_request'
      %li{class: ("active" if params[:status] == 'closed')}
        = link_to dashboard_filter_path(entity, status: 'closed') do
          Closed
          %span.count
            = Issue.with_state(:closed).count if entity == 'issue'
            = current_user.cared_merge_requests.closed.count if entity == 'merge_request'
      %li{class: ("active" if params[:status] == 'all')}
        = link_to dashboard_filter_path(entity, status: 'all') do
          All
          %span.count
            = Issue.count if entity == 'issue'
            = current_user.cared_merge_requests.count if entity == 'merge_request'

  %fieldset
    %legend Projects:
    %ul.nav.nav-pills.nav-stacked
      - @projects.each do |project|
        - unless entities_per_project(project, entity).zero?
          %li{class: ("active" if params[:project_id] == project.id.to_s)}
            = link_to dashboard_filter_path(entity, project_id: project.id) do
              = project.name_with_namespace
              %small.pull-right= entities_per_project(project, entity)

  %fieldset(style="margin-right:10px;")
    %hr
    = link_to "Reset", dashboard_filter_path(entity), class: 'btn pull-right'

